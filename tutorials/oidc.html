<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>OIDC | Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link canonical="https://tsed.io">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="apple-touch-icon">
  <link rel="icon" href="/apple-touch-icon.png" type="image/x-icon" sizes="180x180">
  <link rel="icon" href="/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="icon" href="/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="manifest" href="/site.webmanifest">
  <meta property="og:url" content="https://tsed.io">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.">
  <meta property="og:title" content="Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.">
  <meta property="og:description" content="A Node.js and TypeScript Framework on top of Express/Koa.js. It provides a lot of decorators and guidelines to write your code.">
  <meta property="og:image" content="https://tsed.io/tsed-og.png">
  <meta property="og:image:width" content="1024">
  <meta property="og:image:height" content="1024">
  <meta name="twitter:title" content="Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.">
  <meta name="twitter:description" content="A Node.js and TypeScript Framework on top of Express/Koa.js. It provides a lot of decorators and guidelines to write your code.">
  <meta name="twitter:card" content="summary">
  <link rel="preconnect" href="https://DH8VVM2E1E-dsn.algolia.net" crossOrigin="true">
    <meta name="description" content="Use oidc-provider with Express.js/Koa.js, TypeScript and Ts.ED. oidc-provider is an OAuth 2.0 Authorization Server with OpenID Connect and many additional features and standards implemented.">
    <meta name="keywords" content="ts.ed express koa oidc typescript node.js javascript decorators">
    <meta property="og:url" content="https://tsed.io">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.">
    <meta property="og:title" content="Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.">
    <meta property="og:description" content="A Node.js and TypeScript Framework on top of Express/Koa.js. It provides a lot of decorators and guidelines to write your code.">
    <meta property="og:image" content="https://tsed.io/tsed-og.png">
    <meta property="og:image:width" content="1024">
    <meta property="og:image:height" content="1024">
    <meta name="twitter:title" content="Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js.">
    <meta name="twitter:description" content="A Node.js and TypeScript Framework on top of Express/Koa.js. It provides a lot of decorators and guidelines to write your code.">
    <meta name="twitter:card" content="summary">
    
    <link rel="preload" href="/assets/css/0.styles.aaed514a.css" as="style"><link rel="preload" href="/assets/js/app.1dcf2291.js" as="script"><link rel="preload" href="/assets/js/3.945dde24.js" as="script"><link rel="preload" href="/assets/js/12.0a1d4158.js" as="script"><link rel="prefetch" href="/assets/js/10.559ec120.js"><link rel="prefetch" href="/assets/js/11.84515612.js"><link rel="prefetch" href="/assets/js/13.e298b2e4.js"><link rel="prefetch" href="/assets/js/14.fe072952.js"><link rel="prefetch" href="/assets/js/15.a6639494.js"><link rel="prefetch" href="/assets/js/16.d7f6d697.js"><link rel="prefetch" href="/assets/js/17.ddbe9c8d.js"><link rel="prefetch" href="/assets/js/18.dd452819.js"><link rel="prefetch" href="/assets/js/19.de0e4432.js"><link rel="prefetch" href="/assets/js/2.d0aafafa.js"><link rel="prefetch" href="/assets/js/20.4bd7f3d8.js"><link rel="prefetch" href="/assets/js/21.8d4ed803.js"><link rel="prefetch" href="/assets/js/22.866fa770.js"><link rel="prefetch" href="/assets/js/23.166ea6f3.js"><link rel="prefetch" href="/assets/js/24.fafee80b.js"><link rel="prefetch" href="/assets/js/25.544f2138.js"><link rel="prefetch" href="/assets/js/26.a009e8b4.js"><link rel="prefetch" href="/assets/js/27.9d10d24b.js"><link rel="prefetch" href="/assets/js/28.4293bd18.js"><link rel="prefetch" href="/assets/js/29.a2eeeb9c.js"><link rel="prefetch" href="/assets/js/30.46103491.js"><link rel="prefetch" href="/assets/js/31.c9acf7dc.js"><link rel="prefetch" href="/assets/js/32.663746e0.js"><link rel="prefetch" href="/assets/js/33.2b0b7cea.js"><link rel="prefetch" href="/assets/js/34.d8f41fbe.js"><link rel="prefetch" href="/assets/js/35.ba9cb2e3.js"><link rel="prefetch" href="/assets/js/36.3d09e39d.js"><link rel="prefetch" href="/assets/js/37.4e590e92.js"><link rel="prefetch" href="/assets/js/38.6c449f13.js"><link rel="prefetch" href="/assets/js/39.a3940c4f.js"><link rel="prefetch" href="/assets/js/4.9de5aba7.js"><link rel="prefetch" href="/assets/js/40.33af46de.js"><link rel="prefetch" href="/assets/js/41.9b7a2b51.js"><link rel="prefetch" href="/assets/js/42.5143f922.js"><link rel="prefetch" href="/assets/js/43.89d4557e.js"><link rel="prefetch" href="/assets/js/44.6cd452b5.js"><link rel="prefetch" href="/assets/js/45.7435759f.js"><link rel="prefetch" href="/assets/js/46.c23eddaa.js"><link rel="prefetch" href="/assets/js/47.8b9065b4.js"><link rel="prefetch" href="/assets/js/48.48e51627.js"><link rel="prefetch" href="/assets/js/49.7af783d9.js"><link rel="prefetch" href="/assets/js/5.e4dd3b56.js"><link rel="prefetch" href="/assets/js/50.e2027706.js"><link rel="prefetch" href="/assets/js/51.9947430e.js"><link rel="prefetch" href="/assets/js/52.57d4aa61.js"><link rel="prefetch" href="/assets/js/53.0f10029f.js"><link rel="prefetch" href="/assets/js/54.2e56569a.js"><link rel="prefetch" href="/assets/js/55.397149a4.js"><link rel="prefetch" href="/assets/js/56.65403cf9.js"><link rel="prefetch" href="/assets/js/57.3dc7c7b3.js"><link rel="prefetch" href="/assets/js/58.52f5de01.js"><link rel="prefetch" href="/assets/js/59.94a727e0.js"><link rel="prefetch" href="/assets/js/6.7115a9a1.js"><link rel="prefetch" href="/assets/js/60.748f2621.js"><link rel="prefetch" href="/assets/js/61.49566644.js"><link rel="prefetch" href="/assets/js/62.aea58d1e.js"><link rel="prefetch" href="/assets/js/63.c02a990e.js"><link rel="prefetch" href="/assets/js/64.e532ef1e.js"><link rel="prefetch" href="/assets/js/65.0cb74572.js"><link rel="prefetch" href="/assets/js/66.b44354ce.js"><link rel="prefetch" href="/assets/js/67.83418833.js"><link rel="prefetch" href="/assets/js/68.df391900.js"><link rel="prefetch" href="/assets/js/69.247eeed8.js"><link rel="prefetch" href="/assets/js/7.105a0cdc.js"><link rel="prefetch" href="/assets/js/70.3fb4c04c.js"><link rel="prefetch" href="/assets/js/71.ef65cbd0.js"><link rel="prefetch" href="/assets/js/72.492b5a65.js"><link rel="prefetch" href="/assets/js/73.25ba3d40.js"><link rel="prefetch" href="/assets/js/74.f3e70a54.js"><link rel="prefetch" href="/assets/js/8.db0f79ba.js"><link rel="prefetch" href="/assets/js/9.94ff9e62.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aaed514a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="init"><div class="theme-container with-sidebar"><header class="navbar px-5 flex items-center navbar-box-shadow fixed top-0 fixed top-0 inset-x-0 h-16 bg-white"><div class="flex h-full items-center justify-center md:hidden"><div class="flex cursor-pointer text-xl mr-4"><i class="bx bx-menu"></i></div></div> <div class="flex h-full items-center justify-center m-0 p-0  mr-8"><a href="/" class="router-link-active"><!----> <span class="text-xl text-normal"><strong class="font-medium"><span class='text-blue'>Ts</span>.ED</strong></span></a></div> <div class="flex-1 h-full"><nav class="font-bold hidden lg:flex h-full"><ul class="flex items-center h-full text-gray-dark"><li class="mx-1 content-wrapper py-4"><a href="/getting-started/" title="Getting started | Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js." class="link internal px-3 p-1 hover:bg-blue hover:text-white transition-all rounded-small cursor-pointer"><!----> 
        Getting started
      </a></li><li class="mx-1 content-wrapper py-4"><a href="/getting-started/migration-from-v6.html" title="Migrate from v6 | Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js." class="link internal px-3 p-1 hover:bg-blue hover:text-white transition-all rounded-small cursor-pointer"><!----> 
        Migration
      </a></li><li class="mx-1 content-wrapper"><div class="dropdown-wrapper relative flex items-center h-full px-3 py-4 -hover"><div class="flex items-center h-full w-full"><a title="Documentation | Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js." class="flex items-center hover:text-gray-darker cursor-pointer transition-all duration-500 ease-in-out"><span>Documentation</span> <i class="bx bx-chevron-down"></i></a></div> <div class="nav-dropdown absolute text-gray-darker z-2"> <ul class="reset-list text-gray-darker"><li><!----> <a href="/docs/configuration.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Configuration</span></a></li><li class="mt-3"><!----> <a href="/docs/controllers.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Controllers</span></a></li><li class="mt-3"><!----> <a href="/docs/providers.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Providers</span></a></li><li class="mt-3"><!----> <a href="/docs/model.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Models</span></a></li><li class="mt-3"><!----> <a href="/docs/json-mapper.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Json Mapper</span></a></li><li class="mt-3"><!----> <a href="/docs/middlewares.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Middlewares</span></a></li><li class="mt-3"><!----> <a href="/docs/pipes.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Pipes</span></a></li><li class="mt-3"><!----> <a href="/docs/interceptors.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Interceptors</span></a></li><li class="mt-3"><!----> <a href="/docs/authentication.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Authentication</span></a></li><li class="mt-3"><!----> <a href="/docs/hooks.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Hooks</span></a></li><li class="mt-3"><!----> <a href="/docs/response-filter.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Response filter</span></a></li><li class="mt-3"><!----> <a href="/docs/exceptions.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Exceptions</span></a></li><li class="mt-3"><!----> <a href="/docs/logger.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Logger</span></a></li><li class="mt-3"><!----> <a href="/docs/request-context.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Context</span></a></li><li class="mt-3"><!----> <a href="/docs/cache.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Cache</span></a></li><li class="mt-3"><!----> <a href="/docs/platform-api.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Platform API</span></a></li><li class="mt-3"><!----> <a href="/docs/command.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Command</span></a></li><li class="mt-3"><!----> <a href="/docs/templating.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Templating</span></a></li><li class="mt-3"><!----> <a href="/docs/validation.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Validation</span></a></li><li class="mt-3"><!----> <a href="/tutorials/session.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Session &amp; Cookies</span></a></li><li class="mt-3"><!----> <a href="/docs/testing.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Testing</span></a></li></ul></div></div></li><li class="mx-1 content-wrapper"><div class="dropdown-wrapper relative flex items-center h-full px-3 py-4 -hover"><div class="flex items-center h-full w-full"><a title="Warehouse | Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js." class="flex items-center hover:text-gray-darker cursor-pointer transition-all duration-500 ease-in-out"><span>Warehouse</span> <i class="bx bx-chevron-down"></i></a></div> <div class="nav-dropdown absolute text-gray-darker z-2"> <ul class="reset-list text-gray-darker"><li><!----> <a href="/warehouse/" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Explore plugins</span></a></li><li class="mt-3"><!----> <a href="/tutorials/" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all router-link-active"><!----> <span class="flex-1">Project examples</span></a></li></ul></div></div></li><li class="mx-1 content-wrapper"><div class="dropdown-wrapper relative flex items-center h-full px-3 py-4 -hover"><div class="flex items-center h-full w-full"><a title="Tutorials | Ts.ED - A Node.js and TypeScript Framework on top of Express/Koa.js." class="flex items-center hover:text-gray-darker cursor-pointer transition-all duration-500 ease-in-out"><span>Tutorials</span> <i class="bx bx-chevron-down"></i></a></div> <div class="nav-dropdown absolute text-gray-darker z-2"> <ul class="reset-list text-gray-darker"><li><!----> <a href="/tutorials/ajv.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">AJV</span></a></li><li class="mt-3"><!----> <a href="/tutorials/aws.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">AWS</span></a></li><li class="mt-3"><!----> <a href="/tutorials/agenda.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Agenda</span></a></li><li class="mt-3"><!----> <a href="/tutorials/graphql.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">GraphQL</span></a></li><li class="mt-3"><!----> <a href="/tutorials/ioredis.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">IORedis</span></a></li><li class="mt-3"><!----> <a href="/tutorials/keycloak.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Keycloak</span></a></li><li class="mt-3"><!----> <a href="/tutorials/mikroorm.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">MikroORM</span></a></li><li class="mt-3"><!----> <a href="/tutorials/mongoose.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Mongoose</span></a></li><li class="mt-3"><!----> <a href="/tutorials/oidc.html" aria-current="page" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all router-link-exact-active router-link-active"><!----> <span class="flex-1">OIDC</span></a></li><li class="mt-3"><!----> <a href="/tutorials/objection.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Objection.js</span></a></li><li class="mt-3"><!----> <a href="/tutorials/passport.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Passport.js</span></a></li><li class="mt-3"><!----> <a href="/tutorials/prisma.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Prisma</span></a></li><li class="mt-3"><!----> <a href="/tutorials/serverless.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Serverless</span></a></li><li class="mt-3"><!----> <a href="/tutorials/socket-io.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Socket.io</span></a></li><li class="mt-3"><!----> <a href="/tutorials/stripe.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Stripe</span></a></li><li class="mt-3"><!----> <a href="/tutorials/swagger.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Swagger</span></a></li><li class="mt-3"><!----> <a href="/tutorials/terminus.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Terminus</span></a></li><li class="mt-3"><!----> <a href="/tutorials/typeorm.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">TypeORM</span></a></li></ul></div></div></li><li class="mx-1 content-wrapper"><div class="dropdown-wrapper relative flex items-center h-full px-3 py-4 -hover"><div class="flex items-center h-full w-full"><a title="Extras" class="flex items-center hover:text-gray-darker cursor-pointer transition-all duration-500 ease-in-out"><span></span> <i class="bx bx-dots-horizontal-rounded text-lg"></i></a></div> <div class="nav-dropdown absolute text-gray-darker z-2"> <ul class="reset-list text-gray-darker"><li><!----> <a href="http://cli.tsed.io" target="_blank" rel="noopener noreferrer" class="link external flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><span class="flex-1">Ts.ED CLI</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="mt-3"><!----> <a href="http://logger.tsed.io" target="_blank" rel="noopener noreferrer" class="link external flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><span class="flex-1">Ts.ED Logger</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="mt-3"><!----> <a href="/team.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Team</span></a></li><li class="mt-3"><!----> <a href="/tutorials/" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all router-link-active"><!----> <span class="flex-1">Resources</span></a></li><li class="mt-3"><!----> <a href="/contributing.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Contributes</span></a></li><li class="mt-3"><!----> <a href="/support.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">Support</span></a></li><li class="mt-3"><!----> <a href="/license.html" class="link internal flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><!----> <span class="flex-1">License</span></a></li><li class="mt-3"><!----> <a href="https://api-docs.tsed.io/api.html" target="_blank" rel="noopener noreferrer" class="link external flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><span class="flex-1">Api reference</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div></li></ul></nav></div> <div class="flex h-full"><nav class="hidden sm:flex"><ul class="flex items-center h-full text-gray-dark"><li class="mx-1 content-wrapper"><div class="dropdown-wrapper relative flex items-center h-full px-3 py-4 -hover"><div class="flex items-center h-full w-full"><a title="Current version" class="flex items-center hover:text-gray-darker cursor-pointer transition-all duration-500 ease-in-out"><span>v7.28.0</span> <i class="bx bx-chevron-down"></i></a></div> <div class="nav-dropdown absolute text-gray-darker z-2"> <ul class="reset-list text-gray-darker"><li><!----> <a href="https://v6.tsed.io" target="_blank" rel="noopener noreferrer" class="link external flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><span class="flex-1">v6 (maintenance)</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="mt-3"><!----> <a href="http://v5.tsed.io" target="_blank" rel="noopener noreferrer" class="link external flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><span class="flex-1">v5 (obsolete)</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="mt-3"><!----> <a href="http://v4.tsed.io" target="_blank" rel="noopener noreferrer" class="link external flex items-center justify-center text-sm block opacity-75 hover:opacity-100 p-0 px-6 mt-1 mb-2 cursor-pointer transition-all"><span class="flex-1">v4 (obsolete)</span> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div></li></ul></nav></div> <div class="flex items-center h-full"><a title="Github" href="https://github.com/tsedio/tsed" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center lg:text-lg py-4"><i class="bx bxl-github"></i> </a><a title="Slack" href="https://api.tsed.io/rest/slack/tsedio/tsed" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center lg:text-lg py-4"><i class="bx bxl-slack"></i> </a><a title="Twitter" href="https://twitter.com/TsED_io" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center lg:text-lg py-4"><i class="bx bxl-twitter"></i> </a><a title="StackOverflow" href="https://stackoverflow.com/search?q=tsed" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center lg:text-lg py-4"><i class="bx bxl-stack-overflow"></i> </a><a title="Support us" href="https://tsed.io/support.html" target="_blank" rel="noopener noreferrer" show-title="true" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center lg:text-lg py-4"><i class="bx bxs-heart"></i> <span class="hidden sm:block text-sm font-bold ml-1 mr-1">Support us</span></a></div> <div class="flex items-center h-full"><div id="docsearch"></div></div></header> <div class="sidebar-mask"></div> <main class="main-content relative z-2 pt-16"><div><div><div class="relative"><div class="page-header"><div class="bg-gray-lighter z-5 relative"><div class="page-header-container px-5 md:px-10 max-w-site m-auto flex items-center"><div class="flex-1"><div class="transition-all text-xl font-bold md:font-normal md:text-4xl">
          OIDC
        </div></div> <ul class="flex items-center justify-center text-md -ml-2"><li title="Share"><!----></li> <!----> <li title="View Code Github" class="p-2"><a target="_blank" href="https://github.com/tsedio/tsed/blob/production/docs/tutorials/oidc.md" class="hover:text-blue-active"><i class="bx bx-code-alt"></i></a></li> <li title="Edit Page" class="p-2"><a target="_blank" href="https://github.com/tsedio/tsed/edit/production/docs/tutorials/oidc.md" class="hover:text-blue-active"><i class="bx bx-edit"></i></a></li> <li title="Report a Bug" class="p-2 last:pr-0"><a target="_blank" href="https://github.com/tsedio/tsed/issues/new?title=%5BBUG%5D%20Page%20OIDC%20-%20%2Ftutorials%2Foidc" class="hover:text-blue-active"><i class="bx bx-bug"></i></a></li></ul></div></div></div></div> <div class="px-5 md:px-10 max-w-site m-auto"><div class="page-content"><article> <div class="content__default"><h1 id="oidc"><a href="#oidc" class="header-anchor">#</a> OIDC</h1> <span class="inline-block rounded-small px-2 text-white text-sm normal-case bg-emerald" style="vertical-align:top;">beta</span> <span class="inline-block rounded-small px-2 text-white text-sm normal-case bg-emerald" style="vertical-align:top;">Contributors are welcome</span> <div class="flex justify-center items-center"><a href="https://github.com/panva/node-oidc-provider" class="block m-auto p-5 rounded-full bg-" style="width:100px;height:100px;"><div class="h-full w-full bg-contain bg-no-repeat bg-center" style="background-image:url(https://oauth.net/images/oauth-logo-square.png);"></div> <img src="https://oauth.net/images/oauth-logo-square.png" height="100" class="hidden"></a></div> <p><a href="https://github.com/panva/node-oidc-provider" target="_blank" rel="noopener noreferrer">oidc-provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is an OAuth 2.0 Authorization Server with OpenID Connect
and many additional features and standards implemented.</p> <div class="custom-block tip"><p class="custom-block-title">Certification</p> <p>Filip Skokan has <a href="https://openid.net/certification/" target="_blank" rel="noopener noreferrer">certified<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
that <a href="https://github.com/panva/node-oidc-provider" target="_blank" rel="noopener noreferrer">oidc-provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> conforms to the following profiles of the OpenID
Connect™ protocol</p> <ul><li>OP Basic, Implicit, Hybrid, Config, Dynamic, Form Post, and 3rd Party-Init</li> <li>OP Front-Channel Logout, Back-Channel Logout, RP-Initiated Logout, and Session Management</li> <li>OP FAPI R/W MTLS and Private Key</li></ul></div> <div class="bg-gray-lighter rounded-small my-5  p-5"><div class="-m-3"><ul class="reset-list flex flex-wrap items-center"><li class="p-3"><a href="https://github.com/tsedio/tsed-example-oidc" title="Kit OIDC" target="_blank" rel="noopener noreferrer" class="link external reset-link transition-all duration-500 ease-in-out relative no-underline hover:scale-110 text-xxs text-blue hover:text-blue-active"><figure class="flex items-center justify-center relative z-2 overflow-hidden rounded-medium mb-2 bg-white shadow-undefined p-undefined" style="width:65px;height:65px;"><img data-url="https://oauth.net/images/oauth-logo-square.png" class="w-full opacity-0 transition-all no-shadow"></figure> <!----> <span class="flex items-center justify-center whitespace-pre font-undefined" style="width:65px;">Kit OIDC</span> <!----></a></li></ul></div></div> <h2 id="oidc-compatibility"><a href="#oidc-compatibility" class="header-anchor">#</a> OIDC compatibility</h2> <ul><li>For OIDC v7, use <code>@tsed/oidc-provider</code> v7.19 and under</li> <li>For OIDC v8, use <code>@tsed/oidc-provider</code> v7.21 and higher</li></ul> <p>Since the v8, have changed the exported Provider (named by default) and the entire is under ESM convention, Ts.ED isn't
able to maintain the v7 and v8 at the same time.</p> <h2 id="features"><a href="#features" class="header-anchor">#</a> Features</h2> <p>Ts.ED provides decorators and services to create an OIDC provider with your Ts.ED application.</p> <ul><li>Create interactions policies,</li> <li>Create views,</li> <li>Use adapters to connect oidc-provider with redis/mongo/etc...</li> <li>Automatically create jwks keys on startup</li></ul> <h2 id="installation"><a href="#installation" class="header-anchor">#</a> Installation</h2> <p>Before using the <code>@tsed/oidc-provider</code> package, we need to install
the <a href="https://www.npmjs.com/package/oidc-provider" target="_blank" rel="noopener noreferrer">oidc-provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> module.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save oidc-provider
<span class="token function">npm</span> <span class="token function">install</span> --save @tsed/oidc-provider @tsed/jwks @tsed/adapters
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Then we need to follow these steps:</p> <ul><li>Configure the oidc server,</li> <li>Create the Accounts provider</li> <li>Create the Interactions controller,</li> <li>Create our first Login interaction and views,</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Select &quot;OpenID Connect provider&quot; upon initialization with the Ts.ED CLI and the following will be automatically
generated.</p></div> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>To use oidc-provider with Ts.ED it requires some other Ts.ED features to work properly.</p> <ul><li>Adapters to manage database connection,</li> <li><a href="/docs/templating.html#configuration">Views</a> to display pages.</li></ul> <p>Use <code>tsed init yourApp</code> to create a TSed application and adjust <code>Server.ts</code>:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Configuration<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/di&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Accounts<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./services/Accounts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>InteractionsCtrl<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./controllers/oidc/InteractionsCtrl&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Configuration</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  httpPort<span class="token operator">:</span> <span class="token number">8083</span><span class="token punctuation">,</span>
  mount<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;/&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>InteractionsCtrl<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  adapters<span class="token operator">:</span> <span class="token punctuation">{</span>
    lowdbDir<span class="token operator">:</span> <span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;..&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Adapter<span class="token operator">:</span> FileSyncAdapter
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  oidc<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// path: &quot;/oidc&quot;,</span>
    Accounts<span class="token operator">:</span> Accounts<span class="token punctuation">,</span>
    jwksPath<span class="token operator">:</span> <span class="token function">join</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;..&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;..&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;keys&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jwks.json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// allowHttpLocalhost: false, // by default. true in dev mode and false in production</span>
    clients<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        client_id<span class="token operator">:</span> <span class="token string">&quot;client_id&quot;</span><span class="token punctuation">,</span>
        client_secret<span class="token operator">:</span> <span class="token string">&quot;client_secret&quot;</span><span class="token punctuation">,</span>
        redirect_uris<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;http://localhost:3000&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        response_types<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;id_token&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        grant_types<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;implicit&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        token_endpoint_auth_method<span class="token operator">:</span> <span class="token string">&quot;none&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    claims<span class="token operator">:</span> <span class="token punctuation">{</span>
      openid<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;sub&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      email<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email_verified&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    features<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// disable the packaged interactions</span>
      devInteractions<span class="token operator">:</span> <span class="token punctuation">{</span>enabled<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      encryption<span class="token operator">:</span> <span class="token punctuation">{</span>enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      introspection<span class="token operator">:</span> <span class="token punctuation">{</span>enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      revocation<span class="token operator">:</span> <span class="token punctuation">{</span>enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  views<span class="token operator">:</span> <span class="token punctuation">{</span>
    root<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./views</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">{</span>
      ejs<span class="token operator">:</span> <span class="token string">&quot;ejs&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><h3 id="options"><a href="#options" class="header-anchor">#</a> Options</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>Type<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>JwksKeyParameters<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/jwks&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// @ts-ignore</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>Configuration<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>Adapter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/adapters&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span>OidcAccountsMethods<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./OidcAccountsMethods&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">OidcSettings</span> <span class="token keyword">extends</span> <span class="token class-name">Configuration</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * force the secure cookie. By default, in dev mode it's disabled and in production it's enabled.
   */</span>
  secureCookies<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Path on which the oidc-provider instance is mounted.
   */</span>
  path<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Issuer URI. By default, Ts.ED create issuer with http://localhost:${httpPort}
   */</span>
  issuer<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Path to store jwks keys.
   */</span>
  jwksPath<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Generate jwks from given certificates
   */</span>
  certificates<span class="token operator">?</span><span class="token operator">:</span> JwksKeyParameters<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Secure keys.
   */</span>
  secureKey<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Enable proxy.
   */</span>
  proxy<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Allow redirect_uri on HTTP protocol and localhost domain.
   */</span>
  allowHttpLocalhost<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Injectable service to manage accounts.
   */</span>
  Accounts<span class="token operator">?</span><span class="token operator">:</span> Type<span class="token operator">&lt;</span>OidcAccountsMethods<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Injectable adapter to manage database connexion.
   */</span>
  Adapter<span class="token operator">?</span><span class="token operator">:</span> Type<span class="token operator">&lt;</span>Adapter<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Use the connection name for the OIDCRedisAdapter.
   */</span>
  connectionName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  plugins<span class="token operator">?</span><span class="token operator">:</span> TsED<span class="token punctuation">.</span>OIDCPluginSettings<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">declare</span> global <span class="token punctuation">{</span>
  <span class="token keyword">namespace</span> TsED <span class="token punctuation">{</span>
    <span class="token keyword">interface</span> <span class="token class-name">OIDCPluginSettings</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">interface</span> <span class="token class-name">Configuration</span> <span class="token punctuation">{</span>
      oidc<span class="token operator">:</span> OidcSettings<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p>Documentation on other options properties can be found on
the <a href="https://github.com/panva/node-oidc-provider/blob/master/docs/README.md" target="_blank" rel="noopener noreferrer">oidc-provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> documentation page.</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>It is advised to set <code>path</code> to <code>/oidc</code> to prevent oidc-provider becoming the default exception handler on all routes. In
future versions of Ts.ED this will be the default value.</p></div> <h2 id="use-redis"><a href="#use-redis" class="header-anchor">#</a> Use Redis <span class="inline-block rounded-small px-2 text-white text-sm normal-case bg-emerald" style="vertical-align:top;">6.129.0+</span></h2> <p>Ts.ED provide a Redis adapter for OIDC provider. You just have to install <code>@tsed/adapters-redis</code> and configure a redis
connection to store
all OIDC provider data in Redis.</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i --save @tsed/redis-adapters @tsed/ioredis ioredis
<span class="token function">npm</span> i --save-dev ioredis-mock
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Then create a new <code>RedisConnection.ts</code> for your new redis connection:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> Redis <span class="token keyword">from</span> <span class="token string">&quot;ioredis&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>registerConnectionProvider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/ioredis&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">REDIS_CONNECTION</span> <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;REDIS_CONNECTION&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name"><span class="token constant">REDIS_CONNECTION</span></span> <span class="token operator">=</span> Redis<span class="token punctuation">;</span>

<span class="token function">registerConnectionProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  provide<span class="token operator">:</span> <span class="token constant">REDIS_CONNECTION</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;default&quot;</span> <span class="token comment">// you can change this name at your conveniance</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>You can find more details on <a href="/tutorials/ioredis.html">@tsed/ioredis documentation</a>.</p></div> <p>Then edit the Server settings:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>OIDCRedisAdapter<span class="token punctuation">,</span> RedisAdapter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/adapters-redis&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Configuration<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/di&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Accounts<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./services/Accounts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>InteractionsCtrl<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./controllers/oidc/InteractionsCtrl&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Configuration</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  httpPort<span class="token operator">:</span> <span class="token number">8083</span><span class="token punctuation">,</span>
  mount<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;/&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>InteractionsCtrl<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  redis<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;default&quot;</span>
      <span class="token comment">// add redis configuration</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  adapters<span class="token operator">:</span> <span class="token punctuation">{</span>
    Adapter<span class="token operator">:</span> RedisAdapter<span class="token punctuation">,</span>
    connectionName<span class="token operator">:</span> <span class="token string">&quot;default&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  oidc<span class="token operator">:</span> <span class="token punctuation">{</span>
    Adapter<span class="token operator">:</span> OIDCRedisAdapter<span class="token punctuation">,</span>
    connectionName<span class="token operator">:</span> <span class="token string">&quot;default&quot;</span>
    <span class="token comment">/// other options</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Server</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>That all!</p> <h2 id="allow-http-localhost"><a href="#allow-http-localhost" class="header-anchor">#</a> Allow HTTP &amp; localhost</h2> <p>By default, Ts.ED enable HTTP and localhost domain as a valid redirect uri for your OIDC project. But, sometimes you
want to allow also HTTP and localhost domain in your <code>integration</code> or <code>QA</code>
environment.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Configuration</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  oidc<span class="token operator">:</span> <span class="token punctuation">{</span>
    allowHttpLocalhost<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="secure-cookies"><a href="#secure-cookies" class="header-anchor">#</a> Secure cookies</h2> <p>By default, Ts.ED disable the secureCookies options in <code>development</code> mode and enable it in <code>production</code> mode. But,
sometimes this options in <code>integration</code> environment because your server isn't under a Https protocol.</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Configuration</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  oidc<span class="token operator">:</span> <span class="token punctuation">{</span>
    secureCookies<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="tls-proxy"><a href="#tls-proxy" class="header-anchor">#</a> TLS proxy</h2> <p>The OpenID Connect specification does not allow unsecured HTTP requests and oidc-provider blocks them by default. While
there is a <a href="https://github.com/panva/node-oidc-provider/blob/main/recipes/implicit_http_localhost.md" target="_blank" rel="noopener noreferrer">workaround<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, the
proper way is to use a TLS offloading proxy in front of your app.
When developing, the easiest way is to use <a href="https://caddyserver.com/" target="_blank" rel="noopener noreferrer">Caddy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. To use it, set <code>proxy: true</code> in
your <a href="#Options">options</a> and then run:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>caddy reverse-proxy --from localhost:8443 --to localhost:8083
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="accounts"><a href="#accounts" class="header-anchor">#</a> Accounts</h2> <p>oidc-provider requires an Account model to find an account during an interaction. The model can be used in conjunction
with the adapter to fetch an account.</p> <div class="tabs -code -position-top text-gray-darker"><div class="tabs__header bg-gray-lighter-active"><ul class="reset-list tabs__header--ul -center"></ul></div> <div class="tabs__body  bg-gray-lighter"><!----> <!----></div></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Claims method is used by oidc-provider to expose this information in the userInfo endpoint.</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>We use the <code>$onInit</code> hook to create the first account automatically. You can adapt the script to your needs.</p></div> <h2 id="interactions"><a href="#interactions" class="header-anchor">#</a> Interactions</h2> <p>Interactions are the user flows in oidc-provider. For example, the login page is considered by oidc-provider as an
interaction.
We can define many interactions during the authentication flow, for example:</p> <ul><li>Login,</li> <li>E-mail verification,</li> <li>Password recovery,</li> <li>Sharing account data consent,</li> <li>etc.</li></ul> <p>To have a working OIDC server with Ts.ED, we need to create at least a login and a consent interaction.
To start, we have to create the <code>Interactions</code> controller which will be responsible to run all of our future
custom interactions.</p> <p>In your controller's directory, create the <code>oidc/InteractionsCtrl.ts</code> file and copy the following code:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Get<span class="token punctuation">,</span> PathParams<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Interactions<span class="token punctuation">,</span> OidcCtx<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Name<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/schema&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>AbortInteraction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../interactions/AbortInteraction&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ConsentInteraction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../interactions/ConsentInteraction&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>CustomInteraction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../interactions/CustomInteraction&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>LoginInteraction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../interactions/LoginInteraction&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Name</span></span><span class="token punctuation">(</span><span class="token string">&quot;Oidc&quot;</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Interactions</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">&quot;/interaction/:uid&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">// this list define the priority of each interaction!</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>LoginInteraction<span class="token punctuation">,</span> ConsentInteraction<span class="token punctuation">,</span> CustomInteraction<span class="token punctuation">,</span> AbortInteraction<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">InteractionsCtrl</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;/:interaction?&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">prompt</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">PathParams</span></span><span class="token punctuation">(</span><span class="token string">&quot;interaction&quot;</span><span class="token punctuation">)</span> interaction<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">OidcCtx</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> oidcCtx<span class="token operator">:</span> OidcCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> oidcCtx<span class="token punctuation">.</span><span class="token function">runInteraction</span><span class="token punctuation">(</span>interaction<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>The controller Interactions exposes the routes to display any interaction. Here we expose the route
GET <code>/interation/:uid</code></p> <p>The <code>uid</code> is the unique session id used by oidc-provider to identify the current user flow.</p></div> <div class="custom-block tip"><p class="custom-block-title">Note</p> <p><code>children</code> option define the priority order of each interaction. In our example, LoginInteraction have a priority over
ContentInteraction, CustomInteraction and AbortInteraction.
Changing order her may affect the interaction behavior when the <code>/authorize</code> endpoint is called by the consumer.</p> <p>Another possibility is to define <code>priority</code> option on <a href="" title="Interaction" class="reset-link symbol-container -bubble "><span><span class="symbol undefined"></span></span> <span class="overflow-hidden truncate ">
    Interaction
  </span></a> decorator. In this case, the <code>children</code> order
won't be
had an effect on the interaction priority.</p></div> <p>Now that we have our interaction controller, we can create our first interaction.</p> <p>Create a new directory <code>interactions</code>. We will store all custom interactions in this directory.</p> <div class="tabs -code -position-top text-gray-darker"><div class="tabs__header bg-gray-lighter-active"><ul class="reset-list tabs__header--ul -center"></ul></div> <div class="tabs__body  bg-gray-lighter"><!----> <!----> <!----></div></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>$prompt</code> is a special hook called by your Interactions controller.</p></div> <p>At this step, you can start the OIDC server and check the logs server to see if the well-known configuration
has been correctly exposed:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span><span class="token number">2021</span>-01-04T07:35:31.523<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO <span class="token punctuation">]</span> <span class="token punctuation">[</span>TSED<span class="token punctuation">]</span> - WellKnown is available on http://0.0.0.0:8083/.well-known/openid-configuration
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Try also to open the link in your browser!</p> <p>Now, we need to add the Views to display our login page. Create a views directory on root level and create the following
files:</p> <div class="tabs -code -position-top text-gray-darker"><div class="tabs__header bg-gray-lighter-active"><ul class="reset-list tabs__header--ul -center"></ul></div> <div class="tabs__body  bg-gray-lighter"><!----> <!----> <!----> <!----> <!----></div></div> <p>The login page is ready to be displayed. To test it, open the following link:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://localhost:8083/auth?client_id=client_id&amp;response_type=id_token&amp;scope=openid&amp;nonce=foobar&amp;redirect_uri=http://localhost:3000

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><figure><img alt="Oidc login page" src="/assets/img/signin-page.e5cb5f7e.png" style="max-height:400px;"></figure> <h2 id="create-custom-interaction"><a href="#create-custom-interaction" class="header-anchor">#</a> Create custom interaction</h2> <p>Here a custom interaction with extra methods to configure checks precondition and details information:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>View<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Env<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/core&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Constant<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/di&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Interaction<span class="token punctuation">,</span> InteractionMethods<span class="token punctuation">,</span> OidcCtx<span class="token punctuation">,</span> OidcSession<span class="token punctuation">,</span> Params<span class="token punctuation">,</span> Prompt<span class="token punctuation">,</span> Uid<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Name<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/schema&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>interactionPolicy<span class="token punctuation">,</span> KoaContextWithOIDC<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Check <span class="token operator">=</span> interactionPolicy<span class="token punctuation">.</span>Check<span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Interaction</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
  requestable<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Name</span></span><span class="token punctuation">(</span><span class="token string">&quot;Oidc&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CustomInteraction</span> <span class="token keyword">implements</span> <span class="token class-name">InteractionMethods</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Constant</span></span><span class="token punctuation">(</span><span class="token string">&quot;env&quot;</span><span class="token punctuation">)</span>
  env<span class="token operator">:</span> Env<span class="token punctuation">;</span>

  <span class="token function">$onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">/**
   * return checks conditions. See: https://github.com/panva/node-oidc-provider/blob/main/docs/README.md#interactionspolicy
   */</span>
  <span class="token function">checks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
      <span class="token keyword">new</span> <span class="token class-name">Check</span><span class="token punctuation">(</span><span class="token string">&quot;no_session&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;End-User authentication is required&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>oidc<span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>oidc<span class="token punctuation">.</span>session<span class="token operator">?.</span>accountId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// @ts-ignore</span>
          <span class="token keyword">return</span> Check<span class="token punctuation">.</span><span class="token constant">NO_NEED_TO_PROMPT</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// @ts-ignore</span>
        <span class="token keyword">return</span> Check<span class="token punctuation">.</span><span class="token constant">REQUEST_PROMPT</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * return checks conditions. See: https://github.com/panva/node-oidc-provider/blob/main/docs/README.md#interactionspolicy
   */</span>
  <span class="token function">details</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> KoaContextWithOIDC<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>oidc<span class="token punctuation">}</span> <span class="token operator">=</span> ctx<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token punctuation">(</span>oidc<span class="token punctuation">.</span>params<span class="token operator">?.</span>max_age <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token punctuation">{</span>max_age<span class="token operator">:</span> oidc<span class="token punctuation">.</span>params<span class="token punctuation">.</span>max_age<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token punctuation">(</span>oidc<span class="token punctuation">.</span>params<span class="token operator">?.</span>login_hint <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token punctuation">{</span>login_hint<span class="token operator">:</span> oidc<span class="token punctuation">.</span>params<span class="token punctuation">.</span>login_hint<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token punctuation">(</span>oidc<span class="token punctuation">.</span>params<span class="token operator">?.</span>id_token_hint <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token punctuation">{</span>id_token_hint<span class="token operator">:</span> oidc<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id_token_hint<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">View</span></span><span class="token punctuation">(</span><span class="token string">&quot;custom&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">$prompt</span><span class="token punctuation">(</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">OidcCtx</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> oidcCtx<span class="token operator">:</span> OidcCtx<span class="token punctuation">,</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Prompt</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> prompt<span class="token operator">:</span> Prompt<span class="token punctuation">,</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">OidcSession</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> session<span class="token operator">:</span> OidcSession<span class="token punctuation">,</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Params</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> params<span class="token operator">:</span> Params<span class="token punctuation">,</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">Uid</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> uid<span class="token operator">:</span> Uid
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> oidcCtx<span class="token punctuation">.</span><span class="token function">checkClientId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> oidcCtx<span class="token punctuation">.</span><span class="token function">interactionPrompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span> <span class="token string">&quot;Sign-in Custom&quot;</span><span class="token punctuation">,</span>
      flash<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><p>See more details on: https://github.com/panva/node-oidc-provider/blob/main/docs/README.md#interactionspolicy</p> <h2 id="alter-configuration"><a href="#alter-configuration" class="header-anchor">#</a> Alter configuration</h2> <p>Some part of the OIDC provider configuration needs function to work. And ideally these functions should have access to
our Ts.ED Services.</p> <p>It's possible to do that by listening the <code>$alterOidcConfiguration</code> hook and inject the expected functions in the
configuration:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>PlatformContext<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>InjectContext<span class="token punctuation">,</span> Module<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/di&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>AuthorizationCode<span class="token punctuation">,</span> BackchannelAuthenticationRequest<span class="token punctuation">,</span> DeviceCode<span class="token punctuation">,</span> RefreshToken<span class="token punctuation">,</span> Client<span class="token punctuation">,</span> OidcSettings<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>KoaContextWithOIDC<span class="token punctuation">,</span> Provider<span class="token punctuation">,</span> ResourceServer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;oidc-provider&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Module</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">OidcResourceIndicatorsModule</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">InjectContext</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">protected</span> $ctx<span class="token operator">:</span> PlatformContext<span class="token punctuation">;</span> <span class="token comment">// retrieve the Ts.ED context</span>

  <span class="token keyword">async</span> <span class="token function">$alterOidcConfiguration</span><span class="token punctuation">(</span>config<span class="token operator">:</span> OidcSettings<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>OidcSettings<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// example with the</span>
    config<span class="token punctuation">.</span>features<span class="token operator">!</span><span class="token punctuation">.</span>resourceIndicators <span class="token operator">=</span> <span class="token punctuation">{</span>
      enabled<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      defaultResource<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">defaultResource</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      getResourceServerInfo<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getResourceServerInfo</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      useGrantedResource<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">useGrantedResource</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> config<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token function">defaultResource</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> KoaContextWithOIDC<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">///</span>
    <span class="token keyword">return</span> <span class="token string">&quot;https://mydomain.com&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token function">getResourceServerInfo</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> KoaContextWithOIDC<span class="token punctuation">,</span> resourceIndicator<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> client<span class="token operator">:</span> Client<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ResourceServer<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">///</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">protected</span> <span class="token keyword">async</span> <span class="token function">useGrantedResource</span><span class="token punctuation">(</span>
    ctx<span class="token operator">:</span> KoaContextWithOIDC<span class="token punctuation">,</span>
    model<span class="token operator">:</span> AuthorizationCode <span class="token operator">|</span> RefreshToken <span class="token operator">|</span> DeviceCode <span class="token operator">|</span> BackchannelAuthenticationRequest
  <span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="alter-oidc-policy"><a href="#alter-oidc-policy" class="header-anchor">#</a> Alter OIDC policy</h2> <p>Ts.ED emits a special <code>$alterOidcPolicy</code> event when @tsed/oidc-provider links interactions with OIDC policy. You can
change the policy configuration
by adding <code>$alterOidcPolicy</code> on InteractionsCtrl:</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Get<span class="token punctuation">,</span> PathParams<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/common&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Interactions<span class="token punctuation">,</span> OidcCtx<span class="token punctuation">,</span> DefaultPolicy<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>LoginInteraction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../../interactions/LoginInteraction&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Interactions</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">&quot;/interaction/:uid&quot;</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span>
    LoginInteraction <span class="token comment">// register its children interations</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">InteractionsCtrl</span> <span class="token punctuation">{</span>
  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Get</span></span><span class="token punctuation">(</span><span class="token string">&quot;/:name?&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">promptInteraction</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">PathParams</span></span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">OidcCtx</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> oidcCtx<span class="token operator">:</span> OidcCtx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> oidcCtx<span class="token punctuation">.</span><span class="token function">runInteraction</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">$alterOidcPolicy</span><span class="token punctuation">(</span>policy<span class="token operator">:</span> DefaultPolicy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something</span>

    <span class="token keyword">return</span> policy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="implement-your-own-adapter"><a href="#implement-your-own-adapter" class="header-anchor">#</a> Implement your own adapter</h2> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>OidcAdapterMethods<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/oidc-provider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Adapter<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsed/adapters&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CustomAdapter<span class="token operator">&lt;</span>Model <span class="token keyword">extends</span> AdapterModel<span class="token operator">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">Adapter<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">OidcAdapterMethods</span> <span class="token punctuation">{</span>
  <span class="token comment">//</span>
  <span class="token comment">// implement all required methods</span>
  <span class="token comment">//</span>
  <span class="token function">create</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Omit<span class="token operator">&lt;</span>Model<span class="token punctuation">,</span> <span class="token string">&quot;_id&quot;</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span> expiresAt<span class="token operator">?</span><span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">update</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Model<span class="token punctuation">,</span> expiresAt<span class="token operator">?</span><span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">updateOne</span><span class="token punctuation">(</span>predicate<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span><span class="token punctuation">,</span> expiresAt<span class="token operator">?</span><span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">upsert</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> Model<span class="token punctuation">,</span> expiresAt<span class="token operator">?</span><span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">findOne</span><span class="token punctuation">(</span>predicate<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">findAll</span><span class="token punctuation">(</span>predicate<span class="token operator">?</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">deleteOne</span><span class="token punctuation">(</span>predicate<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">deleteMany</span><span class="token punctuation">(</span>predicate<span class="token operator">:</span> Partial<span class="token operator">&lt;</span>Model<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Model <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token comment">//</span>
  <span class="token comment">// if you use redis implement also the following methods</span>
  <span class="token comment">//</span>
  <span class="token keyword">async</span> <span class="token function">findByUserCode</span><span class="token punctuation">(</span>userCode<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">findByUid</span><span class="token punctuation">(</span>uid<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">destroy</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">revokeByGrantId</span><span class="token punctuation">(</span>grantId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">consume</span><span class="token punctuation">(</span>grantId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>You can find original adapters from oidc-provider project
here: https://github.com/panva/node-oidc-provider/blob/main/example/adapters</p></div> <h2 id="debug"><a href="#debug" class="header-anchor">#</a> Debug</h2> <p>Use <code>DEBUG=oidc-provider:*</code> for debugging oidc-provider.</p> <h2 id="support-oidc-provider"><a href="#support-oidc-provider" class="header-anchor">#</a> Support oidc-provider</h2> <p>If you or your business uses <a href="https://github.com/panva/node-oidc-provider" target="_blank" rel="noopener noreferrer">oidc-provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, please consider becoming a
sponsor, so we can continue maintaining it and adding new features carefree.</p> <h2 id="author"><a href="#author" class="header-anchor">#</a> Author</h2> <div class="-m-2 mb-5"><ul class="reset-list flex flex-wrap items-center"></ul></div> <h2 id="maintainers"><a href="#maintainers" class="header-anchor">#</a> Maintainers</h2> <div class="-m-2 mb-5"><ul class="reset-list flex flex-wrap items-center"></ul></div> <div class="flex items-center justify-center p-5"><a href="/contributing.html" title="" class="link internal rounded-medium reset-link inline-flex flex-col items-stretch overflow-hidden text-base transition-colors
  bg-blue border-blue text-white-button focus:bg-blue-active focus:border-blue-active
  hover:bg-blue-active hover:border-blue-active focus:text-white-button-active hover:text-white-button-active
   cursor-pointer border-1 border-solid rounded-small shadow-none"><!----> <span class="flex justify-center items-center w-full font-bold px-4 py-1"><span class="m-1 text-center flex justify-center items-center">
 Become maintainer
</span></span></a></div></div> </article> <div class="pt-5"><div class="py-5 flex justify-end text-sm"><p><span class="font-bold pr-1">Last Updated:</span> <span class="time">5/11/2023, 2:16:20 PM</span></p></div> <div class="page-nav pt-5 mb-10"><div class="flex align-center justify-between overflow-hidden"><span class="flex align-center justify-center"><a href="/tutorials/mongoose.html" class="p-2 pr-3 transition duration-500 ease-in-out hover:bg-white-active rounded-small hover:text-white text-md font-medium flex items-center justify-between"><i class="bx bx-chevron-left"></i> <span>
            Mongoose
          </span></a></span> <span class="flex align-center justify-center"><a href="/tutorials/objection.html" class="p-2 pl-3 transition duration-500 ease-in-out hover:bg-white-active rounded-small hover:text-white text-md font-medium flex items-center justify-between"><span>
            Objection.js
          </span> <i class="bx bx-chevron-right"></i></a></span></div></div></div> <section slot="page-bottom" class="other-topics px-3"><h4 class="text-xl mb-4 mt-2 font-semibold">
            Other topics
          </h4> <ul class="flex justify-start flex-wrap -mx-1"><li class="p-1"><a href="/tutorials/session.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Session &amp; cookies
      </a></li><li class="p-1"><a href="/tutorials/passport.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Passport.js
      </a></li><li class="p-1"><a href="/tutorials/keycloak.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Keycloak
      </a></li><li class="p-1"><a href="/tutorials/prisma.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Prisma
      </a></li><li class="p-1"><a href="/tutorials/typeorm.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">TypeORM
      </a></li><li class="p-1"><a href="/tutorials/mikroorm.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">MikroORM
      </a></li><li class="p-1"><a href="/tutorials/mongoose.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Mongoose
      </a></li><li class="p-1"><a href="/tutorials/graphql.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">GraphQL
      </a></li><li class="p-1"><a href="/tutorials/socket-io.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Socket.io
      </a></li><li class="p-1"><a href="/tutorials/swagger.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Swagger
      </a></li><li class="p-1"><a href="/tutorials/ajv.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">AJV
      </a></li><li class="p-1"><a href="/tutorials/multer.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Multer
      </a></li><li class="p-1"><a href="/tutorials/serve-static-files.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Serve static files
      </a></li><li class="p-1"><a href="/tutorials/templating.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Templating
      </a></li><li class="p-1"><a href="/tutorials/aws.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Serverless HTTP
      </a></li><li class="p-1"><a href="/tutorials/seq.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Seq
      </a></li><li class="p-1"><a href="/tutorials/oidc.html" aria-current="page" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white router-link-exact-active router-link-active">OIDC
      </a></li><li class="p-1"><a href="/tutorials/stripe.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Stripe
      </a></li><li class="p-1"><a href="/tutorials/agenda.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Agenda
      </a></li><li class="p-1"><a href="/tutorials/terminus.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Terminus
      </a></li><li class="p-1"><a href="/tutorials/serverless.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Serverless
      </a></li><li class="p-1"><a href="/tutorials/ioredis.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">IORedis
      </a></li><li class="p-1"><a href="/docs/controllers.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Controllers
      </a></li><li class="p-1"><a href="/docs/providers.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Providers
      </a></li><li class="p-1"><a href="/docs/model.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Model
      </a></li><li class="p-1"><a href="/docs/json-mapper.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">JsonMapper
      </a></li><li class="p-1"><a href="/docs/middlewares.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Middlewares
      </a></li><li class="p-1"><a href="/docs/pipes.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Pipes
      </a></li><li class="p-1"><a href="/docs/interceptors.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Interceptors
      </a></li><li class="p-1"><a href="/docs/authentication.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Authentication
      </a></li><li class="p-1"><a href="/docs/hooks.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Hooks
      </a></li><li class="p-1"><a href="/docs/exceptions.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Exceptions
      </a></li><li class="p-1"><a href="/docs/throw-http-exceptions.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Throw HTTP Exceptions
      </a></li><li class="p-1"><a href="/docs/cache.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Cache
      </a></li><li class="p-1"><a href="/docs/command.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Command
      </a></li><li class="p-1"><a href="/docs/response-filter.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Response Filter
      </a></li><li class="p-1"><a href="/docs/injection-scopes.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Injection scopes
      </a></li><li class="p-1"><a href="/docs/custom-providers.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Custom providers
      </a></li><li class="p-1"><a href="/docs/providers-lazy-loading.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Lazy-loading provider
      </a></li><li class="p-1"><a href="/docs/custom-endpoint-decorators.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Custom endpoint decorator
      </a></li><li class="p-1"><a href="/docs/testing.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Testing
      </a></li><li class="p-1"><a href="/docs/not-found-page.html" class="text-xs no-underline py-1 px-2 bg-gray-lighter rounded-small hover:bg-blue hover:text-white">Customize 404
      </a></li></ul> </section></div></div> <aside class="page-sidebar fixed overflow-auto"> <ul class="page-sidebar-sub-headers"><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#oidc-compatibility" class="page-sidebar-link ">OIDC compatibility</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#features" class="page-sidebar-link ">Features</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#installation" class="page-sidebar-link ">Installation</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#configuration" class="page-sidebar-link ">Configuration</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#use-redis" class="page-sidebar-link ">Use Redis</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#allow-http-localhost" class="page-sidebar-link ">Allow HTTP &amp; localhost</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#secure-cookies" class="page-sidebar-link ">Secure cookies</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#tls-proxy" class="page-sidebar-link ">TLS proxy</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#accounts" class="page-sidebar-link ">Accounts</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#interactions" class="page-sidebar-link ">Interactions</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#create-custom-interaction" class="page-sidebar-link ">Create custom interaction</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#alter-configuration" class="page-sidebar-link ">Alter configuration</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#alter-oidc-policy" class="page-sidebar-link ">Alter OIDC policy</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#implement-your-own-adapter" class="page-sidebar-link ">Implement your own adapter</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#debug" class="page-sidebar-link ">Debug</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#support-oidc-provider" class="page-sidebar-link ">Support oidc-provider</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#author" class="page-sidebar-link ">Author</a></li><li class="page-sidebar-sub-header"><a href="/tutorials/oidc.html#maintainers" class="page-sidebar-link ">Maintainers</a></li></ul> </aside></div></div></main> <aside class="sidebar -translate-x-100 md:shadow-sidebar md:translate-x-0"> <ul class="reset-list py-5"><li><div class="mb-2"><a href="/getting-started/" class="sidebar-link relative block py-2 font-bold text-gray-darker text-md px-5">Introduction</a></div></li><li><div class="mb-2"><a href="/getting-started/start-with-cli.html" class="sidebar-link relative block py-2 font-bold text-gray-darker text-md px-5">Create new project</a></div></li><li><div class="mb-2"><a href="/getting-started/create-your-first-controller.html" class="sidebar-link relative block py-2 font-bold text-gray-darker text-md px-5">Create your first controller</a></div></li><li><section class="sidebar-group mb-2 collapsable depth-0"><p class="cursor-pointer font-bold text-gray-darker flex items-center justify-center text-md pl-5 pr-2 py-1"><span class="flex-1">Migration</span> <i class="bx bx-chevron-down text-xl transition-all -rotate-90"></i></p> <!----></section></li><li><section class="sidebar-group mb-2 collapsable depth-0"><p class="cursor-pointer font-bold text-gray-darker flex items-center justify-center text-md pl-5 pr-2 py-1"><span class="flex-1">Documentation</span> <i class="bx bx-chevron-down text-xl transition-all -rotate-90"></i></p> <!----></section></li><li><section class="sidebar-group mb-2 collapsable depth-0"><p class="cursor-pointer font-bold text-gray-darker flex items-center justify-center text-md pl-5 pr-2 py-1"><span class="flex-1">Advanced</span> <i class="bx bx-chevron-down text-xl transition-all -rotate-90"></i></p> <!----></section></li><li><section class="sidebar-group mb-2 collapsable depth-0"><p class="cursor-pointer font-bold text-gray-darker flex items-center justify-center text-md pl-5 pr-2 py-1 open"><span class="flex-1">Plugins</span> <i class="bx bx-chevron-down text-xl transition-all"></i></p> <ul><li><a href="/tutorials/ajv.html" class="sidebar-link relative block py-2 pl-7">AJV</a></li><li><a href="/tutorials/aws.html" class="sidebar-link relative block py-2 pl-7">AWS</a></li><li><a href="/tutorials/agenda.html" class="sidebar-link relative block py-2 pl-7">Agenda</a></li><li><a href="/tutorials/graphql.html" class="sidebar-link relative block py-2 pl-7">GraphQL</a></li><li><a href="/tutorials/ioredis.html" class="sidebar-link relative block py-2 pl-7">IORedis</a></li><li><a href="/tutorials/keycloak.html" class="sidebar-link relative block py-2 pl-7">Keycloak</a></li><li><a href="/tutorials/mikroorm.html" class="sidebar-link relative block py-2 pl-7">Mikro ORM</a></li><li><a href="/tutorials/mongoose.html" class="sidebar-link relative block py-2 pl-7">Mongoose</a></li><li><a href="/tutorials/oidc.html" aria-current="page" class="active sidebar-link relative block py-2 pl-7">OIDC</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#oidc-compatibility" class="sidebar-link relative block py-2 ">OIDC compatibility</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#features" class="sidebar-link relative block py-2 ">Features</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#installation" class="sidebar-link relative block py-2 ">Installation</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#configuration" class="sidebar-link relative block py-2 ">Configuration</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#use-redis" class="sidebar-link relative block py-2 ">Use Redis</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#allow-http-localhost" class="sidebar-link relative block py-2 ">Allow HTTP &amp; localhost</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#secure-cookies" class="sidebar-link relative block py-2 ">Secure cookies</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#tls-proxy" class="sidebar-link relative block py-2 ">TLS proxy</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#accounts" class="sidebar-link relative block py-2 ">Accounts</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#interactions" class="sidebar-link relative block py-2 ">Interactions</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#create-custom-interaction" class="sidebar-link relative block py-2 ">Create custom interaction</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#alter-configuration" class="sidebar-link relative block py-2 ">Alter configuration</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#alter-oidc-policy" class="sidebar-link relative block py-2 ">Alter OIDC policy</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#implement-your-own-adapter" class="sidebar-link relative block py-2 ">Implement your own adapter</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#debug" class="sidebar-link relative block py-2 ">Debug</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#support-oidc-provider" class="sidebar-link relative block py-2 ">Support oidc-provider</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#author" class="sidebar-link relative block py-2 ">Author</a></li><li class="sidebar-sub-header"><a href="/tutorials/oidc.html#maintainers" class="sidebar-link relative block py-2 ">Maintainers</a></li></ul></li><li><a href="/tutorials/objection.html" class="sidebar-link relative block py-2 pl-7">Objection.js</a></li><li><a href="/tutorials/swagger.html" class="sidebar-link relative block py-2 pl-7">Open API</a></li><li><a href="/tutorials/passport.html" class="sidebar-link relative block py-2 pl-7">Passport</a></li><li><a href="/tutorials/prisma.html" class="sidebar-link relative block py-2 pl-7">Prisma</a></li><li><a href="/tutorials/serverless.html" class="sidebar-link relative block py-2 pl-7">Serverless</a></li><li><a href="/tutorials/socket-io.html" class="sidebar-link relative block py-2 pl-7">Socket.io</a></li><li><a href="/tutorials/stripe.html" class="sidebar-link relative block py-2 pl-7">Stripe</a></li><li><a href="/tutorials/terminus.html" class="sidebar-link relative block py-2 pl-7">Terminus</a></li><li><a href="/tutorials/typeorm.html" class="sidebar-link relative block py-2 pl-7">TypeORM</a></li></ul></section></li><li><section class="sidebar-group mb-2 collapsable depth-0"><p class="cursor-pointer font-bold text-gray-darker flex items-center justify-center text-md pl-5 pr-2 py-1"><span class="flex-1">Extras</span> <i class="bx bx-chevron-down text-xl transition-all -rotate-90"></i></p> <!----></section></li></ul> </aside> <footer class="relative z-2"><div class="px-5 md:px-10 max-w-site m-auto"><div class="page-content py-5"><div class="flex items-center"><div class="flex-1"><h4 class="text-xl mb-4 mt-2 px-2 font-semibold">Support us</h4> <div class="content__default"><p>
            Ts.ED is an MIT-licensed open source project. It can grow thanks to the support by the
            community. If
            you'd like to join them, please read more <a href="/support.html">here</a>.
          </p> <div class="flex items-center justify-center pt-5 mt-5 mb-5"><a href="https://tsed.io/support.html" title="" target="_blank" rel="noopener noreferrer" class="link external reset-link inline-flex flex-col items-stretch overflow-hidden text-base transition-colors
  bg-white-button border-blue text-blue focus:bg-white-button-active focus:border-blue-active
  hover:bg-white-button-active hover:border-blue-active focus:text-blue-active hover:text-blue-active
   cursor-pointer border-1 border-solid rounded-medium shadow-none"><span class="flex justify-center items-center w-full font-bold px-4 py-1"><span class="m-1 text-center flex justify-center items-center">
              Become sponsor
            </span></span> <!----></a></div></div></div></div></div></div>  <div class="px-5 md:px-10  m-auto bg-code-active relative"><div class="pt-5 pb-8 text-center text-white"><div class="flex items-center"><div class="flex-1 flex items-center justify-center"><a title="Github" href="https://github.com/tsedio/tsed" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center text-xl py-4 mx-2"><i class="bx bxl-github"></i> </a><a title="Slack" href="https://api.tsed.io/rest/slack/tsedio/tsed" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center text-xl py-4 mx-2"><i class="bx bxl-slack"></i> </a><a title="Twitter" href="https://twitter.com/TsED_io" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center text-xl py-4 mx-2"><i class="bx bxl-twitter"></i> </a><a title="StackOverflow" href="https://stackoverflow.com/search?q=tsed" target="_blank" rel="noopener noreferrer" class="p-1 hover:text-blue-active transition-all duration-500 ease-in-out flex flex align-center justify-center text-xl py-4 mx-2"><i class="bx bxl-stack-overflow"></i> </a></div> <div class="absolute top-0 right-0 pt-5 pr-8 pr-10"><div class="relative inline-flex w-auto"><!----> <span class="text-xs py-1 px-2 absolute right-0 rounded-medium rounded-bl-small bg-white text-blue" style="top:-12px;right:-28px;">0</span></div></div></div> <div class="w-full max-w-site m-auto"><div class="flex flex-col sm:flex-row text-center sm:text-left items-start content-center justify-between pt-5 sm:mb-5 sm:py-5"><div class="flex-1 w-full sm:w-auto mb-8 sm:mb-0"><h3 class="font-bold uppercase text-lg pb-4 transition-colors duration-300 ease-linear">
    Discover
  </h3> <ul class="transition-colors duration-300 ease-linear"><li class="py-2"><a href="/team.html" aria-current="page" class="link internal text-gray-light font-bold hover:text-blue-active"><!----> 
        Our team
      </a></li><li class="py-2"><a href="https://form.typeform.com/to/uJLP7anG" target="_blank" rel="noopener noreferrer" aria-current="page" class="link external text-gray-light font-bold hover:text-blue-active">
        Contact us
       <!----></a></li></ul></div> <div class="flex-1 w-full sm:w-auto mb-8 sm:mb-0 sm:text-center"><h3 class="font-bold uppercase text-lg pb-4 transition-colors duration-300 ease-linear">
    Help
  </h3> <ul class="transition-colors duration-300 ease-linear"><li class="py-2"><a href="/tutorials/index.html" aria-current="page" class="link internal text-gray-light font-bold hover:text-blue-active"><!----> 
        Resources
      </a></li><li class="py-2"><a href="https://api.tsed.io/rest/slack/tsedio/tsed" target="_blank" rel="noopener noreferrer" aria-current="page" class="link external text-gray-light font-bold hover:text-blue-active">
        Chat with us
       <!----></a></li><li class="py-2"><a href="/contributing.html" aria-current="page" class="link internal text-gray-light font-bold hover:text-blue-active"><!----> 
        Contribution guide
      </a></li></ul></div> <div class="flex-1 w-full sm:w-auto mb-8 sm:mb-0 sm:text-right"><h3 class="font-bold uppercase text-lg pb-4 transition-colors duration-300 ease-linear">
    Support
  </h3> <ul class="transition-colors duration-300 ease-linear"><li class="py-2"><a href="https://github.com/tsedio/tsed/issues" target="_blank" rel="noopener noreferrer" aria-current="page" class="link external text-gray-light font-bold hover:text-blue-active">
        Issues
       <!----></a></li><li class="py-2"><a href="/support.html" aria-current="page" class="link internal text-gray-light font-bold hover:text-blue-active"><!----> 
        Sponsoring &amp; donations
      </a></li></ul></div></div></div> <div class="text-sm">
        Copyright © 2016-2023 <a href="/license.html" class="text-blue font-bold hover:text-blue-active">MIT License</a> <span class="inline-block text-gray-light px-1">|</span> By
        Lenzotti Romain
      </div></div></div> </footer></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1dcf2291.js" defer></script><script src="/assets/js/3.945dde24.js" defer></script><script src="/assets/js/12.0a1d4158.js" defer></script>
  </body>
</html>
